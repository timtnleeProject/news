{"version":3,"sources":["helper/store.js","components/NewsList/index.js","components/NewsList/news.module.css","helper/api.js","helper/data.js","routes/Explore/explore.module.css","routes/Explore/index.js"],"names":["globalStore","initialStore","this","key","value","expired","Error","str","JSON","stringify","localStorage","setItem","getItem","date","parsed","parse","Date","now","getTime","removeItem","clear","setting","country","category","params","q","get","News","props","info","source","name","author","push","publishedAt","toLocaleString","className","styles","item","onClick","window","open","url","image","style","backgroundImage","content","title","join","description","NewsList","news","list","map","i","urlToImage","module","exports","CONFIG","api","origin","token","instance","axios","create","baseURL","timeout","headers","interceptors","response","use","data","status","Promise","reject","getTopHeadlines","store","localHeadlines","resolve","then","res","milisec","headlines","articles","save","anHour","getEverything","ob1","ob2","localParams","Object","keys","some","localEverything","fetchEverything","Explore","_isMounted","state","handleQuery","bind","handleKeydown","search","setState","e","target","keyCode","input","onChange","onKeyDown","btn","length","React","Component"],"mappings":"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","file":"static/js/5.8821c122.chunk.js","sourcesContent":["const isExpired = (date) => {\n  if (!date) return false\n  return Date.now() > new Date(date).getTime()\n}\n\nexport class Store {\n  constructor (initialStore) {\n    this.initialStore = initialStore\n  }\n  save ({ key, value, expired }) {\n    if (!value || typeof value !== 'object') throw new Error('value must be an object')\n    const str = JSON.stringify({\n      value,\n      expired\n    })\n    localStorage.setItem(key, str)\n  }\n  get (key) {\n    const str = localStorage.getItem(key)\n    if (!str) return this.initialStore[key] || null\n    const parsed = JSON.parse(str)\n    if (isExpired(parsed.expired)) {\n      return this.initialStore[key] || null\n    } else {\n      return parsed.value\n    }\n  }\n  remove (key) {\n    localStorage.removeItem(key)\n  }\n  clear () {\n    localStorage.clear()\n  }\n}\n\nconst globalStore = new Store({\n  setting: {\n    country: 'tw',\n    category: 'general'\n  },\n  params: {\n    q: 'Apple'\n  }\n})\n// developing\nconst setting = globalStore.get('setting')\nif ((!setting.country || setting.category) || globalStore.get('params') === null) globalStore.clear() \n// store.clear()\nexport default globalStore\n","import React from 'react';\nimport styles from './news.module.css'\n\nfunction News (props) {\n  const openLink = () => {\n    window.open(props.url, '_blank')\n  }\n  const info = [props.source.name]\n  if (props.author) info.push(props.author)\n  const date = props.publishedAt\n    ? new Date(props.publishedAt).toLocaleString()\n    : null\n  return (\n    <div\n      className={styles.item}\n      onClick={openLink}\n    >\n      { props.image\n        ? (\n          <div\n            className={styles.image}\n            style={{backgroundImage: `url(${props.image})`}}\n          ></div>\n        )\n        : null\n      }\n      <div className={styles.content}>\n        <div className={styles.title}>{props.title}</div>\n        <div className={styles.info}>\n          <span>{info.join('/')}</span>\n          <span>{date}</span>\n        </div>\n        <div className={styles.description}>{props.description}</div>\n      </div>\n    </div>\n  )\n}\n\nexport default function NewsList (props) {\n  const news = props.list.map((item, i) => (\n    <News\n      title={item.title}\n      description={item.description}\n      url={item.url}\n      source={item.source}\n      author={item.author}\n      publishedAt={item.publishedAt}\n      image={item.urlToImage}\n      key={i}\n    />\n  ))\n  return (\n    <div>\n      {news}\n    </div>\n  )\n}","// extracted by mini-css-extract-plugin\nmodule.exports = {\"item\":\"news_item__2akXV\",\"content\":\"news_content__3kxe-\",\"title\":\"news_title__3WJqZ\",\"info\":\"news_info__2Ny5e\",\"description\":\"news_description__2LbzD\",\"image\":\"news_image__8z6Aw\"};","import axios from 'axios'\nimport CONFIG from '../config'\nconst { origin, token } = CONFIG.api\n\nconst instance = axios.create({\n  baseURL: origin,\n  timeout: 3000,\n  headers: {\n    'X-Api-Key': token\n  }\n})\ninstance.interceptors.response.use(response => {\n  if (response.data && response.data.status === 'ok') return response.data\n  else return Promise.reject(response)\n})\n\nexport function fetchHeadlines (params) {\n  return instance.get('/top-headlines', {\n    params\n  })\n}\n\nexport function fetchSources ({ country }) {\n  return instance.get('/sources')\n}\n\nexport function fetchEverything ({ q }) {\n  return instance.get('/everything', {\n    params: {\n      q\n    }\n  })\n}","import store from './store';\nimport { fetchHeadlines, fetchEverything } from './api'\n\nconst anHour = 60 * 60 * 1000\nconst dateAfter = (milisec) => {\n  return new Date(Date.now() + milisec)\n}\n\nexport function resetTopHeadlines () {\n  store.remove('headlines')\n}\n\nexport function getTopHeadlines () {\n  const setting = store.get('setting')\n  const { country, category } = setting\n  const localHeadlines = store.get('headlines')\n  if (localHeadlines) return Promise.resolve(localHeadlines)\n  return fetchHeadlines({ country, category }).then(res => {\n    const headlines = res.articles\n    store.save({\n      key: 'headlines',\n      value: headlines,\n      expired: dateAfter(anHour / 2)\n    })\n    return headlines\n  })\n}\n\nconst isSame = (ob1, ob2) => {\n  const keys = Object.keys({...ob1, ob2})\n  const inconsist = keys.some(key => {\n    return ob1[key] !== ob2[key]\n  })\n  return !inconsist\n}\nexport function getEverything (params) {\n  const localParams = store.get('params')\n  if (isSame(localParams, params)) {\n    const localEverything = store.get('everything')\n    if (localEverything) return Promise.resolve(localEverything)\n  }\n  return fetchEverything(params).then(res => {\n    const articles = res.articles\n    store.save({\n      key: 'everything',\n      value: articles\n    })\n    store.save({\n      key: 'params',\n      value: params\n    })\n    return articles\n  })\n}","// extracted by mini-css-extract-plugin\nmodule.exports = {\"search-bar\":\"explore_search-bar__2g1AF\",\"input\":\"explore_input__1VE_f\",\"btn\":\"explore_btn__Mauxj\"};","import React from 'react';\nimport { getEverything } from '../../helper/data'\nimport store from '../../helper/store'\nimport Loading from '../../components/Loading'\nimport NewsList from '../../components/NewsList'\nimport styles from './explore.module.css'\n\nexport default class Explore extends React.Component {\n  _isMounted = false\n  constructor (props) {\n    super(props)\n    this.state = {\n      list: [],\n      q: ''\n    }\n    this.handleQuery = this.handleQuery.bind(this)\n    this.handleKeydown = this.handleKeydown.bind(this)\n    this.search = this.search.bind(this)\n  }\n  componentDidMount () {\n    this._isMounted = true\n    const params = store.get('params')\n    getEverything(params).then(list => {\n      if (this._isMounted) {\n        this.setState({\n          list\n        })\n      }\n    })\n  }\n  componentWillUnmount () {\n    this._isMounted = false\n  }\n  handleQuery (e) {\n    this.setState({\n      q: e.target.value\n    })\n  }\n  handleKeydown (e) {\n    if (e.keyCode === 13) {\n      this.search()\n    }\n  }\n  search () {\n    if (!this.state.q) return\n    this.setState({\n      list: []\n    })\n    getEverything({ q: this.state.q }).then(list => {\n      this.setState({\n        list\n      })\n    })\n  }\n  render () {\n    return (\n      <>\n        <div className={styles['search-bar']}>\n          <input\n            value={this.state.q}\n            className={styles.input}\n            onChange={this.handleQuery}\n            onKeyDown={this.handleKeydown}\n          ></input>\n          <button\n            className={styles.btn}\n            onClick={this.search}\n          >搜尋</button>\n        </div>\n        {\n          this.state.list.length === 0\n            ? <Loading/>\n            : <NewsList list={this.state.list}/>\n        }\n      </>\n    )\n  }\n}\n"],"sourceRoot":""}